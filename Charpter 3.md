<p align='center'>
<a href="https://oxygenpanda.github.io/" target="_blank"><img alt="Website" src="https://img.shields.io/badge/博客-劳振煜的知識倉儲-faf2f2.svg?style=flat-square&logo=Blogger"></a>
<a href="https://www.github.com/OXygenPanda" target="_blank"><img src="https://img.shields.io/badge/Github-@劳振煜-f3e1e1.svg?style=flat-square&logo=GitHub"></a>
<a href="https://i.loli.net/2020/11/11/SBZ2mFJGKLjUtTO.jpg" target="_blank"><img src="https://img.shields.io/badge/微信-@OXygen-f1d1d1.svg?style=flat-square&logo=WeChat"></a>


# 计算机网络 第三章

>   第三章的主要内容是 : 数据链路层

## 数据链路层基本概念及基本问题

### 基本概念

数据发送模型 :

-   主机1 - 电话网 - 路由器1 - 局域网 - 路由器2 - 广域网 - 路由器3 - 局域网 - 主机2.
-   在路由器上数据上升到网络层, 再进行转发.

数据链路层的信道类型 :

-   点对点信道
-   广播信道

链路与数据链路 :

-   链路 (link) 是一条点对点的物理线路段
-   数据链路 (data link) 除了物理线路外, 还必须有通信协议来控制这些数据的传输

帧 :

-   链路层传输的数据单元
-   获得网络层的数据报增加帧头和帧尾, 传递给物理层

### 三个基本问题

1.  封装成帧

    封装成帧就是在一段数据的前后分别添加首部和尾部, 然后就构成一个帧, 确定帧的边界.

    首部和尾部的一个重要作用就是进行帧定界.

    帧的数据部分长度最大为1500字节.

    帧首部和帧尾部定界的作用 : 确保数据的完整性

2.  透明传输

    在帧数据部分出现了SOH帧首部或EOT帧尾部内容, 会出现提前结束.

    解决方法 :

    -   发送端的数据链路层在数据中出现控制字符"SOH"或者"EOT"的前面插入转义字符"ESC"(十六进制编码为1B).
    -   字节填充或字符填充——接收端的数据链路层在将数据送往网络层之前删除插入的转义字符.
    -   如果转义字符也出现在数据中, 那么应该在转义字符前插入一个转义字符. 当接收端收到连续的两个转义字符时, 就删除前面一个.

3.  差错控制

    传输过程中可能会产生比特差错 : 1 可能会变成 0 , 0 可能会变成 1.

    在一段时间内, 传输错误的比特占所传输比特总数的比率称为误码率 BER (bit error rate).

    误码率与信噪比有很大的关系.

    为了保证数据传输的可靠性, 在计算机网络传输数据时, 必须采用各种差错检测措施.

    循环冗余检验 CRC :

    -   在数据链路层传送的帧中, 广泛使用了 CRC 的技术.
    -   在发送端, 先把数据划分为组. 假定每组为 k 个比特
    -   假设待传送的一组数据 M = 101001 (k = 6), 我们在 M 的后面再添加供差错检测用的 n 位冗余码一起发送.
    -   101001 - 000 (增加3位0, 要求除数是4位) / 1101 = 001 (FCS) , 把001加在101001后面, 组成 101001001 , 接收方除以相同的四位数 1101, 如果最终结果是 0 , 说明没有出错. 这个四位数 1101 或者更多位的数, 是链路层保证双方相同的.
    -   链路层的差错控制, 是无差错接收, 只接受没有比特差错的情况, 不需要重传.(重传是传输层的要求)

    帧检验序列 FCS :

    -   在数据后面添加上的冗余码称为帧检验序列 FCS.
    -   循环冗余检验 CRC 和帧检验序列 FCS 并不等同. (CRC 不是获得 FCS 的唯一途径)

## 两种情况下的数据链路层

### 使用点对点信道的数据链路层

PPP协议( Pointer-to-Pointer Protocol)

用户使用拨号电话线接入因特网的时候, 一般都是使用PPP协议. 具有拨号, 身份验证, 可以记账的特性.

PPP协议应该满足的要求 : 简单, 封装成帧, 透明性, 多层网络层协议, 多种类型链路, 差错检测, 检测连接状态, 最大传送单元, 网络层地址协商, 数据压缩协商.

PPP协议不需要满足的要求 : 纠错, 流量控制, 序号, 多点线路, 半双工或单工链路.

PPP协议的组成 :

-   数据链路层协议可以用于异步串行或同步串行介质.
-   它使用LCP(链路控制协议)建立并维护数据链路连接.
-   网络控制协议(NCP)允许在点到点连接上使用多种网络层协议.

|3. 上层协议 : IP IPX AppleTalk |

|2. 网络控制协议 NCP 针对每一个网络层协议 |

|2. 链路控制协议 LCP |

|2. 高级数据链路控制协议 HDLC |

|1. 物理层 |

PPP协议帧格式 :

首部 : | F{1} | A{1} | C{1} | 协议{2} | . 其中, A,C = FF,03 是固定的.

-   协议{2} :
    -   0x0021 - PPP帧的信息字段就是IP数据报
    -   0xC021 - 信息字段是PPP链路控制数据
    -   0x8021 - 网络控制数据
    -   0xC023 - 安全性认证PAP
    -   0xC025 - LQR
    -   0xC223 - 安全性认证CHAP

数据部分 : IP数据报不超过1500字节.

尾部 : | FCS{2} | F{1} | . PPP协议的头尾的 F(=7E) 字段相同.

字节填充 : 信息字段出现标志字段的值的问题 : 信息字段的 0x7E 被拆分称为0x7D 0x5E, 信息字段的 0x7D 被拆分成0x7D 0x5D, ASCII 控制符(数值小于0x20)前加一个 0x7D 字节.(因此实际传输的信息可能是达不到1500字节)

零比特填充方法 :

-   PPP协议用在SONET/SDH链路时, 是使用同步传输一连串的比特连续传送). 这时, PPP协议采用零比特填充方法来实现透明传输.
-   在发送端, 只要连续发现5个连续的1, 就立即填充一个0. 接收端扫描时, 5个连续的1后删除1个0.(可以用于避免0x7E的出现)

PPP协议的工作状态 :

-   当用户拨号接入ISP时, 路由器的调制解调器对拨号做出确认, 并建立一条物理连接.
-   PC机向路由器发送一系列的LCP分组(封装成多个PPP帧).
-   这些分组及其响应选择一些PPP参数, 和进行网络层配置, NCP给新接入的PC机分配一个临时的IP地址, 使PC机称为因特网上的一个主机.
-   通信完毕时, NCP释放网络层连接, 收回原来分配出去的IP地址. 接着, LCP释放数据链路层连接. 最后释放的是物理层连接.

### 使用广播信道的数据链路层

## 以太局域网

## 扩展以太网

## 高速以太网